var fe=Object.create;var F=Object.defineProperty;var de=Object.getOwnPropertyDescriptor;var ge=Object.getOwnPropertyNames;var ye=Object.getPrototypeOf,ke=Object.prototype.hasOwnProperty;var Pe=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Te=(t,e,a,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of ge(e))!ke.call(t,r)&&r!==a&&F(t,r,{get:()=>e[r],enumerable:!(n=de(e,r))||n.enumerable});return t};var P=(t,e,a)=>(a=t!=null?fe(ye(t)):{},Te(e||!t||!t.__esModule?F(a,"default",{value:t,enumerable:!0}):a,t));var y=Pe((st,N)=>{(function(){"use strict";var t={}.hasOwnProperty;function e(){for(var r="",o=0;o<arguments.length;o++){var s=arguments[o];s&&(r=n(r,a(s)))}return r}function a(r){if(typeof r=="string"||typeof r=="number")return r;if(typeof r!="object")return"";if(Array.isArray(r))return e.apply(null,r);if(r.toString!==Object.prototype.toString&&!r.toString.toString().includes("[native code]"))return r.toString();var o="";for(var s in r)t.call(r,s)&&r[s]&&(o=n(o,s));return o}function n(r,o){return o?r?r+" "+o:r+o:r}typeof N<"u"&&N.exports?(e.default=e,N.exports=e):typeof define=="function"&&typeof define.amd=="object"&&define.amd?define("classnames",[],function(){return e}):window.classNames=e})()});import{createContext as ve,useContext as Se,useState as G}from"react";var A=(t,e,a,n)=>{let r=({id:c,audioRef:u,src:p,metadata:m,namespace:T})=>{e(h=>({...h,[c]:{audioRef:u,src:p,isPlaying:!1,currentTime:0,duration:0,isLoaded:!1,volume:1,muted:!1,metadata:m,namespace:T,buffered:[]}}))},o=c=>{let u=t[c];u?.isPlaying&&u.audioRef.current&&u.audioRef.current.pause(),e(p=>{let m={...p};return delete m[c],m}),a===c&&n(null)},s=c=>{let u=t[c];u?.audioRef.current&&(g(c),u.audioRef.current.play().catch(p=>{console.error("Error playing audio:",p)}),n(c),e(p=>({...p,[c]:{...p[c],isPlaying:!0}})))},i=c=>{let u=t[c];u?.audioRef.current&&(u.audioRef.current.pause(),e(p=>({...p,[c]:{...p[c],isPlaying:!1}})),a===c&&n(null))},l=c=>{let u=t[c];u?.audioRef.current&&(u.isPlaying?i(c):s(c))},f=c=>{let u=t[c];u?.audioRef.current&&(u.audioRef.current.pause(),u.audioRef.current.currentTime=0,e(p=>({...p,[c]:{...p[c],isPlaying:!1,currentTime:0}})),a===c&&n(null))},g=c=>{Object.entries(t).forEach(([u,p])=>{u!==c&&p.audioRef.current&&p.isPlaying&&(p.audioRef.current.pause(),e(m=>({...m,[u]:{...m[u],isPlaying:!1}})))})};return{registerTrack:r,unregisterTrack:o,playTrack:s,pauseTrack:i,togglePlayPause:l,stopTrack:f,pauseAllExcept:g}};var w=(t,e)=>({setVolume:(s,i)=>{let l=t[s];if(l?.audioRef.current){let f=Math.max(0,Math.min(1,i));l.audioRef.current.volume=f,e(g=>({...g,[s]:{...g[s],volume:f}}))}},setMuted:(s,i)=>{let l=t[s];l?.audioRef.current&&(l.audioRef.current.muted=i,e(f=>({...f,[s]:{...f[s],muted:i}})))},seekTo:(s,i)=>{let l=t[s];l?.audioRef.current&&(l.audioRef.current.currentTime=i,e(f=>({...f,[s]:{...f[s],currentTime:i}})))},updateTrackMetadata:(s,i)=>{e(l=>l[s]?{...l,[s]:{...l[s],metadata:{...l[s].metadata,...i}}}:l)}});var D=(t,e)=>({getTrackState:s=>t[s],isTrackPlaying:s=>!!t[s]?.isPlaying,getCurrentlyPlayingId:()=>e,getAllTracks:()=>t});import{useEffect as be}from"react";var x=t=>{let e=Math.floor(t/3600),a=Math.floor(t%3600/60).toFixed(0).toString(),n=Math.floor(t%3600%60).toFixed(0).toString().padStart(2,"0"),r=`${a}:${n}`;return e>0&&(r=`${e}:${a.padStart(2,"0")}:${n}`),r};var V=t=>t.replace(/^.*[\\/]/,"").split(".")[0],$=(t,e,a=2)=>Number((t/e*100).toFixed(a));var O=(t,e,a,n)=>{be(()=>{let r=[];return Object.entries(t).forEach(([o,s])=>{let i=s.audioRef.current;if(!i)return;let l=()=>{e(m=>({...m,[o]:{...m[o],currentTime:i.currentTime}}))},f=()=>{e(m=>({...m,[o]:{...m[o],duration:i.duration,isLoaded:!0}}))},g=()=>{e(m=>({...m,[o]:{...m[o],isPlaying:!1,currentTime:0}})),a===o&&n(null)},c=()=>{e(m=>({...m,[o]:{...m[o],isPlaying:!0}})),n(o)},u=()=>{e(m=>({...m,[o]:{...m[o],isPlaying:!1}})),a===o&&n(null)},p=m=>{let T=m.target.buffered,h=Array.from({length:T.length},(R,L)=>{let me=$(T.start(L),i.duration),pe=$(T.end(L),i.duration);return{start:me,end:pe}});e(R=>({...R,[o]:{...R[o],buffered:h}}))};i.addEventListener("timeupdate",l),i.addEventListener("durationchange",f),i.addEventListener("ended",g),i.addEventListener("play",c),i.addEventListener("pause",u),i.addEventListener("progress",p),r.push(()=>{i&&(i.removeEventListener("timeupdate",l),i.removeEventListener("durationchange",f),i.removeEventListener("ended",g),i.removeEventListener("play",c),i.removeEventListener("pause",u),i.removeEventListener("progress",p))})}),()=>{r.forEach(o=>o())}},[t,a,e,n])};import{jsx as he}from"react/jsx-runtime";var H=ve(null),U=({theme:t="picobel",children:e})=>{let[a,n]=G({}),[r,o]=G(null),s=A(a,n,r,o),i=w(a,n),l=D(a,r);O(a,n,r,o);let f={...s,...i,...l,namespace:t};return he(H.Provider,{value:f,children:e})},b=()=>Se(H);var ue=P(y(),1);import{useRef as Ve,useEffect as Oe}from"react";import{createContext as xe,useContext as Ne}from"react";var B=xe(null),I=()=>Ne(B),W=B.Provider;var q=P(y(),1);var d=({trackKey:t,name:e})=>{let a=b(),n=I(),r=n?n.trackKey:t;if(!a)return console.error(`Picobel.${e} must be used within a PicobelProvider`),{valid:!1};if(!r)return console.error(`Picobel.${e} must be used within an instance of Picobel or with an explicit trackKey prop`),{valid:!1};let o=a.getTrackState(r);return o?{valid:!0,trackKey:r,context:a,trackState:o}:{valid:!1}};import{jsx as Ce}from"react/jsx-runtime";var z=({trackKey:t,className:e=""})=>{let{valid:a,trackState:n}=d({trackKey:t,name:"Artist"});if(!a)return null;let{artist:r}=n.metadata;return r?Ce("span",{className:(0,q.default)(`${n.namespace}__artist`,e),children:r}):null};var J=P(y(),1);import{jsx as _e}from"react/jsx-runtime";var Q=({trackKey:t,className:e=""})=>{let{valid:a,trackState:n}=d({trackKey:t,name:"CurrentTime"});return a?_e("span",{className:(0,J.default)(`${n.namespace}__current-time`,`${n.namespace}__timer`,e),children:x(n.currentTime)}):null};var X=P(y(),1);import{jsx as Re}from"react/jsx-runtime";var Y=({trackKey:t,className:e=""})=>{let{valid:a,trackState:n}=d({trackKey:t,name:"Duration"});return a?Re("span",{className:(0,X.default)(`${n.namespace}__duration`,e),children:n.duration?x(n.duration):"-:--"}):null};var Z=P(y(),1);import{useEffect as $e,useState as Ee}from"react";import{jsx as Ke}from"react/jsx-runtime";var j=({trackKey:t,className:e})=>{let{valid:a,trackState:n,trackKey:r,context:o}=d({trackKey:t,name:"Mute"}),[s,i]=Ee(n?.muted||!1);if($e(()=>{a&&i(n.muted)},[n,a]),!a)return null;let l=()=>{o.setMuted(r,!s)};return Ke("button",{type:"button",className:(0,Z.default)(`${n.namespace}__mute`,e,{muted:s}),onClick:l,"aria-label":s?"Unute":"Mute",children:s?"Unmute":"Mute"})};var te=P(y(),1);import{useEffect as Me,useState as Le}from"react";import{jsx as ee}from"react/jsx-runtime";var re=({trackKey:t,className:e})=>{let{valid:a,trackState:n,trackKey:r,context:o}=d({trackKey:t,name:"PlayPause"}),[s,i]=Le(a&&o.getCurrentlyPlayingId()===r);if(Me(()=>{a&&i(o.getCurrentlyPlayingId()===r)},[o,a,r]),!a)return null;let l=()=>{o.togglePlayPause(r)};return ee("button",{type:"button",className:(0,te.default)(`${n.namespace}__play-pause`,e,{playing:s}),onClick:l,"aria-label":s?"Pause":"Play",children:ee("span",{className:`${n.namespace}__play-pause__text`,children:s?"Pause":"Play"})})};var C=P(y(),1);import{useState as ne,useEffect as Fe}from"react";import{jsx as v,jsxs as E}from"react/jsx-runtime";var ae=(t,e,a)=>(t-e)/(a-e)*100,_=({onChange:t,namespace:e,className:a,trackKey:n,min:r=0,max:o=100,value:s=50,step:i,label:l,children:f})=>{let g=`${e}-slider__range--${n}`,[c,u]=ne(ae(s,r,o)),[p,m]=ne(!1);Fe(()=>{u(ae(s,r,o))},[s,r,o]);let T=()=>m(!0),h=()=>m(!1);return E("div",{className:(0,C.default)(e,a),children:[v("label",{className:`${e}-label`,htmlFor:g,children:v("span",{className:`${e}-label-inner`,children:l})}),E("div",{className:(0,C.default)(`${e}-slider__wrapper`,{focus:p}),children:[E("div",{className:(0,C.default)(`${e}-slider__replacement`,{focus:p}),children:[v("div",{className:`${e}-slider__background`}),f,v("div",{className:`${e}-slider__indicator`,style:{width:`${c}%`}}),v("div",{className:`${e}-slider__playhead`,style:{left:`${c}%`}})]}),v("input",{className:`${e}-slider__range`,id:g,type:"range",min:r,max:o,value:s,onFocus:T,onBlur:h,onChange:t,...i&&{step:i}})]})]})};import{jsx as oe}from"react/jsx-runtime";var se=({trackKey:t,className:e})=>{let{valid:a,trackState:n,trackKey:r,context:o}=d({trackKey:t,name:"Progress"});return a?oe(_,{label:"Progress",className:e,onChange:i=>{let l=Number(i.target.value);isNaN(l)||o.seekTo(r,l)},namespace:`${n.namespace}__progress`,min:0,max:n.duration,value:n.currentTime,children:n.buffered.map((i,l)=>oe("div",{className:`${n.namespace}__progress-slider__buffered`,style:{left:`${i.start}%`,right:`${100-i.end}%`}},l))}):null};var ie=P(y(),1);import{jsx as Ae}from"react/jsx-runtime";var ce=({trackKey:t,className:e=""})=>{let{valid:a,trackState:n}=d({trackKey:t,name:"Title"});if(!a)return null;let{title:r}=n.metadata;return Ae("span",{className:(0,ie.default)(`${n.namespace}__title`,e),children:r})};import{jsx as we}from"react/jsx-runtime";var le=({trackKey:t,className:e})=>{let{valid:a,trackState:n,trackKey:r,context:o}=d({trackKey:t,name:"Volume"});return a?we(_,{label:"Volume",className:e,onChange:i=>{let l=Number(i.target.value);isNaN(l)||o.setVolume(r,l)},namespace:`${n.namespace}__volume`,min:0,max:1,step:.01,value:n.muted?0:n.volume}):null};import{Fragment as He,jsx as k,jsxs as S}from"react/jsx-runtime";var Ge=({src:t,id:e,title:a,theme:n,artist:r,className:o="",children:s})=>{let i=e||t,f={title:a||V(t),artist:r},g=Ve(null),c=b();if(!c)throw new Error("Picobel must be used within a PicobelProvider");let u=n||c.namespace;Oe(()=>(c.registerTrack({id:i,audioRef:g,src:t,metadata:f,namespace:u}),()=>{c.unregisterTrack(i)}),[]);let p=c.isTrackPlaying(i);return S("div",{className:(0,ue.default)("picobel",u,{loading:c.fileStatus==="pending"},{playing:p},o),children:[k("audio",{ref:g,src:t}),S(W,{value:{trackKey:i},children:[!s&&S(He,{children:[k(re,{}),S("div",{className:`${u}__wrapper--mute-volume`,children:[k(j,{}),k(le,{})]}),S("div",{className:`${u}__wrapper--title-artist`,children:[k(ce,{}),k(z,{})]}),S("div",{className:`${u}__wrapper--timer-progress-duration`,children:[k(Q,{}),k(se,{}),k(Y,{})]})]}),s]})]})},K=Ge;import{jsx as M}from"react/jsx-runtime";var Ue=t=>b()?M(K,{...t}):M(U,{theme:t.theme,children:M(K,{...t})}),Be=Ue;export{z as Artist,Q as CurrentTime,Y as Duration,j as Mute,U as PicobelProvider,re as PlayPause,se as Progress,ce as Title,le as Volume,Be as default,b as usePicobel};
/*! Bundled license information:

classnames/index.js:
  (*!
  	Copyright (c) 2018 Jed Watson.
  	Licensed under the MIT License (MIT), see
  	http://jedwatson.github.io/classnames
  *)
*/
